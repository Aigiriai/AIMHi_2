ğŸš€ AUTH_ROUTES[rsy6ncmqk]: ============= ORGANIZATIONS ENDPOINT SUCCESS =============
ğŸ“¤ RESPONSE[wp02mcjfs]: ============= OUTGOING RESPONSE =============
ğŸ“¤ RESPONSE[wp02mcjfs]: Status: 200 | Duration: 9ms
ğŸ“¤ RESPONSE[wp02mcjfs]: Response size: 1890 bytes
ğŸ“¤ RESPONSE[wp02mcjfs]: GET /api/auth/organizations?page=1&limit=1000 -> 200 (9ms)
12:12:07 PM [express] GET /api/auth/organizations 304 in 10ms :: {"organizations":[{"id":2,"name":"Aiâ€¦
ğŸ” AUTH[xmtjwlgf5]: ============= AUTHENTICATION START =============
ğŸ” AUTH[xmtjwlgf5]: Request details: {
  method: 'GET',
  path: '/api/admin/logs',
  originalUrl: '/api/admin/logs',
  ip: '172.31.117.2',
  userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWeb...'
}
ğŸ” AUTH[xmtjwlgf5]: Authorization header present: true
ğŸ” AUTH[xmtjwlgf5]: Token extracted: true
ğŸ” AUTH[xmtjwlgf5]: Verifying JWT token...
ğŸ” AUTH[xmtjwlgf5]: Token decoded for user 1 in 1ms
ğŸ” AUTH[xmtjwlgf5]: Token payload: {
  userId: 1,
  iat: 1755778321,
  exp: 1755864721,
  expiresIn: '2025-08-22T12:12:01.000Z'
}
ğŸ” AUTH[xmtjwlgf5]: Getting database connection (attempt 1/3)...
ğŸ” DB_MANAGER[zsdjssrrc]: Getting database instance (PID: 5853)
ğŸ” DB_MANAGER[zsdjssrrc]: Current state - initialized: true, complete: true, initializing: false
âœ… DB_MANAGER[zsdjssrrc]: Returning existing database instance (0ms)
ğŸ” AUTH[xmtjwlgf5]: Database connection obtained in 1ms (attempt 1)
ğŸ” AUTH[xmtjwlgf5]: Querying user data for user 1...
ğŸ” AUTH[xmtjwlgf5]: User query returned 1 results for user 1 in 0ms
âœ… AUTH[xmtjwlgf5]: Authentication successful for user 1 (super_admin) in 3ms
ğŸ” AUTH[xmtjwlgf5]: User data: {
  id: 1,
  email: 'superadmin@aimhi.app',
  role: 'super_admin',
  organizationId: 1
}
ğŸ” AUTH[xmtjwlgf5]: ============= AUTHENTICATION SUCCESS =============
ğŸ“¤ RESPONSE[nf0ipa74f]: ============= OUTGOING RESPONSE =============
ğŸ“¤ RESPONSE[nf0ipa74f]: Status: 200 | Duration: 3ms
ğŸ“¤ RESPONSE[nf0ipa74f]: Response size: 144 bytes
ğŸ“¤ RESPONSE[nf0ipa74f]: GET /api/admin/logs -> 200 (3ms)
12:12:10 PM [express] GET /api/admin/logs 200 in 4ms :: {"directory":"/home/runner/workspace/server/lâ€¦
ğŸ” AUTH[9l41oqo7x]: ============= AUTHENTICATION START =============
ğŸ” AUTH[9l41oqo7x]: Request details: {
  method: 'POST',
  path: '/backup-database',
  originalUrl: '/api/auth/backup-database',
  ip: '172.31.117.2',
  userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWeb...'
}
ğŸ” AUTH[9l41oqo7x]: Authorization header present: true
ğŸ” AUTH[9l41oqo7x]: Token extracted: true
ğŸ” AUTH[9l41oqo7x]: Verifying JWT token...
ğŸ” AUTH[9l41oqo7x]: Token decoded for user 1 in 1ms
ğŸ” AUTH[9l41oqo7x]: Token payload: {
  userId: 1,
  iat: 1755778321,
  exp: 1755864721,
  expiresIn: '2025-08-22T12:12:01.000Z'
}
ğŸ” AUTH[9l41oqo7x]: Getting database connection (attempt 1/3)...
ğŸ” DB_MANAGER[74wyizeln]: Getting database instance (PID: 5853)
ğŸ” DB_MANAGER[74wyizeln]: Current state - initialized: true, complete: true, initializing: false
âœ… DB_MANAGER[74wyizeln]: Returning existing database instance (0ms)
ğŸ” AUTH[9l41oqo7x]: Database connection obtained in 1ms (attempt 1)
ğŸ” AUTH[9l41oqo7x]: Querying user data for user 1...
ğŸ” AUTH[9l41oqo7x]: User query returned 1 results for user 1 in 0ms
âœ… AUTH[9l41oqo7x]: Authentication successful for user 1 (super_admin) in 4ms
ğŸ” AUTH[9l41oqo7x]: User data: {
  id: 1,
  email: 'superadmin@aimhi.app',
  role: 'super_admin',
  organizationId: 1
}
ğŸ” AUTH[9l41oqo7x]: ============= AUTHENTICATION SUCCESS =============
ğŸ”„ MANUAL BACKUP: User superadmin@aimhi.app (super_admin) requested manual database backup
ğŸ“Š MANUAL BACKUP: NODE_ENV = development
ğŸ¢ MANUAL BACKUP: Organization ID = 1
ğŸš¨ Manual backup triggered (any environment): manual_trigger_from_api
ğŸ” BACKUP: Organizations in database: AIM Hi System (aimhi.app), Aigiri (no-domain)
âœ… BACKUP VALIDATION: Database schema is complete, proceeding with backup
ğŸ”„ BACKUP: Creating backup from development.db database...
ğŸ“ BACKUP: Source: /home/runner/workspace/data/development.db
ğŸ“ BACKUP: Target: /home/runner/workspace/backups/dev/backup.db
ğŸ”„ BACKUP: Forcing SQLite checkpoint before backup creation
ğŸ” BACKUP VERIFY: Organizations after checkpoint: AIM Hi System (aimhi.app), Aigiri (no-domain)
â˜ï¸ Uploading database backup: database-backups/dev/development-backup-2025-08-21T12-12-16-719Z.db (148KB)
âœ… Database backup uploaded successfully: database-backups/dev/development-backup-2025-08-21T12-12-16-719Z.db
ğŸ” BACKUP VERIFY: Downloading backup to verify content...
â˜ï¸ Downloading database backup: database-backups/dev/development-backup-2025-08-21T12-12-16-719Z.db
ğŸ”„ Trying downloadAsBytes method as alternative...
ğŸ” downloadAsBytes error details: {
  error: { message: 'Error: Error code undefined' },
  errorType: 'object',
  errorKeys: [ 'message' ],
  errorString: '[object Object]'
}
âŒ Failed to download database backup: ObjectStorageDownloadError: Download failed: Error: Error code undefined
    at DatabaseBackupService.downloadDatabaseBackup (/home/runner/workspace/server/objectStorage.ts:302:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async DatabaseBackupService.verifyBackupContent (/home/runner/workspace/server/objectStorage.ts:126:26)
    at async DatabaseBackupService.createTimestampedBackup (/home/runner/workspace/server/objectStorage.ts:479:3)
    at async DataPersistenceManager.createBackup (/home/runner/workspace/server/data-persistence.ts:94:33)
    at async BackupIntegrationService.forceBackupAnyEnvironment (/home/runner/workspace/server/backup-integration.ts:231:26)
    at async <anonymous> (/home/runner/workspace/server/auth-routes.ts:1200:21) {
  originalError: undefined
}
âŒ Error during backup verification: ObjectStorageDownloadError: Failed to download database backup 'database-backups/dev/development-backup-2025-08-21T12-12-16-719Z.db': Download failed: Error: Error code undefined
    at DatabaseBackupService.downloadDatabaseBackup (/home/runner/workspace/server/objectStorage.ts:341:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async DatabaseBackupService.verifyBackupContent (/home/runner/workspace/server/objectStorage.ts:126:26)
    at async DatabaseBackupService.createTimestampedBackup (/home/runner/workspace/server/objectStorage.ts:479:3)
    at async DataPersistenceManager.createBackup (/home/runner/workspace/server/data-persistence.ts:94:33)
    at async BackupIntegrationService.forceBackupAnyEnvironment (/home/runner/workspace/server/backup-integration.ts:231:26)
    at async <anonymous> (/home/runner/workspace/server/auth-routes.ts:1200:21) {
  originalError: ObjectStorageDownloadError: Download failed: Error: Error code undefined
      at DatabaseBackupService.downloadDatabaseBackup (/home/runner/workspace/server/objectStorage.ts:302:15)
      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
      at async DatabaseBackupService.verifyBackupContent (/home/runner/workspace/server/objectStorage.ts:126:26)
      at async DatabaseBackupService.createTimestampedBackup (/home/runner/workspace/server/objectStorage.ts:479:3)
      at async DataPersistenceManager.createBackup (/home/runner/workspace/server/data-persistence.ts:94:33)
      at async BackupIntegrationService.forceBackupAnyEnvironment (/home/runner/workspace/server/backup-integration.ts:231:26)
      at async <anonymous> (/home/runner/workspace/server/auth-routes.ts:1200:21) {
    originalError: undefined
  }
}
âœ… Database backup created in Object Storage: development-backup-2025-08-21T12-12-16-719Z.db
âœ… Local backup copy created: /home/runner/workspace/backups/dev/backup.db
âœ… Manual backup completed: development-backup-2025-08-21T12-12-16-719Z.db
Audit event (disabled): {
  organizationId: 1,
  userId: 1,
  action: 'manual_backup_requested',
  resourceType: 'system',
  resourceId: undefined,
  details: { requestedBy: 'superadmin@aimhi.app', organizationId: 1 }
}
ğŸ“¤ RESPONSE[leti8hvlp]: ============= OUTGOING RESPONSE =============
ğŸ“¤ RESPONSE[leti8hvlp]: Status: 200 | Duration: 16958ms
ğŸ“¤ RESPONSE[leti8hvlp]: Response size: 106 bytes
ğŸ“¤ RESPONSE[leti8hvlp]: POST /api/auth/backup-database -> 200 (16958ms)
12:12:33 PM [express] POST /api/auth/backup-database 200 in 16958ms :: {"success":true,"message":"Datâ€¦